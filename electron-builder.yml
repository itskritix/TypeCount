# electron-builder configuration
# Use this for production Windows builds with beautiful NSIS installer
# Run: npm run dist:win

appId: com.typecount.app
productName: TypeCount
copyright: Copyright Â© 2025 TypeCount

# Directories
directories:
  output: dist
  buildResources: build

# Files to include
files:
  - "**/*"
  - "!**/node_modules/*/{CHANGELOG.md,README.md,README,readme.md,readme}"
  - "!**/node_modules/*/{test,__tests__,tests,powered-test,example,examples}"
  - "!**/node_modules/*.d.ts"
  - "!**/node_modules/.bin"
  - "!**/*.{iml,o,hprof,orig,pyc,pyo,rbc,swp,csproj,sln,xproj}"
  - "!.editorconfig"
  - "!**/._*"
  - "!**/{.DS_Store,.git,.hg,.svn,CVS,RCS,SCCS,.gitignore,.gitattributes}"

# Extra resources (native modules, assets)
extraResources:
  - from: "assets"
    to: "assets"
  - from: "node_modules/uiohook-napi"
    to: "node_modules/uiohook-napi"
  - from: "node_modules/node-gyp-build"
    to: "node_modules/node-gyp-build"

# ASAR packaging
asar: true
asarUnpack:
  - "node_modules/uiohook-napi/**/*"

# ===========================================
# WINDOWS CONFIGURATION - NSIS INSTALLER
# ===========================================
win:
  target:
    - target: nsis
      arch:
        - x64
  icon: assets/logo.ico
  # Uncomment for code signing:
  # certificateFile: ${env.WIN_CSC_LINK}
  # certificatePassword: ${env.WIN_CSC_KEY_PASSWORD}

nsis:
  # One-click installer (like Discord/Slack) - clean and modern
  oneClick: true

  # Install for current user only (no admin required)
  perMachine: false

  # Allow user to change install directory (only if oneClick: false)
  allowToChangeInstallationDirectory: false

  # Create desktop shortcut
  createDesktopShortcut: true
  createStartMenuShortcut: true
  shortcutName: TypeCount

  # Uninstaller settings
  uninstallDisplayName: TypeCount

  # === INSTALLER BRANDING (Static BMP images - NO GIF NEEDED!) ===
  # These are only used if oneClick: false (assisted installer mode)
  # For one-click mode, only the icon is shown

  # Header image for wizard pages (150x57 BMP)
  # installerHeader: build/installerHeader.bmp

  # Sidebar image for welcome/finish pages (164x314 BMP)
  # installerSidebar: build/installerSidebar.bmp

  # Header icon for one-click installer (above progress bar)
  installerHeaderIcon: assets/logo.ico

  # Custom installer icon
  installerIcon: assets/logo.ico
  uninstallerIcon: assets/logo.ico

  # Run after install
  runAfterFinish: true

  # Delete app data on uninstall
  deleteAppDataOnUninstall: false

  # License (optional)
  # license: LICENSE.txt

  # Custom NSIS script for advanced customization
  # include: build/installer.nsh

# ===========================================
# macOS CONFIGURATION
# ===========================================
mac:
  target:
    - target: dmg
      arch:
        - x64
        - arm64
  icon: assets/icon.icns
  category: public.app-category.productivity
  hardenedRuntime: true
  gatekeeperAssess: false
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist

dmg:
  background: build/dmg-background.png
  iconSize: 100
  contents:
    - x: 130
      y: 220
    - x: 410
      y: 220
      type: link
      path: /Applications

# ===========================================
# LINUX CONFIGURATION
# ===========================================
linux:
  target:
    - target: deb
      arch:
        - x64
    - target: rpm
      arch:
        - x64
    - target: AppImage
      arch:
        - x64
  icon: assets/icon.png
  category: Utility
  maintainer: itskritix@gmail.com
  vendor: TypeCount
  synopsis: Keystroke analytics and productivity tracking
  description: Professional keystroke analytics and productivity tracking application

# ===========================================
# PUBLISH CONFIGURATION (for auto-updates)
# ===========================================
publish:
  provider: github
  owner: itskritix
  repo: TypeCount
  releaseType: release
